<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <script src="{{vscodeElementsScript}}" type="module"></script>
  </head>
  <body>
    <vscode-table bordered-rows>
      <vscode-table-header slot="header" id="table-header">
      </vscode-table-header>
      <vscode-table-body slot="body" id="table-body"> </vscode-table-body>
    </vscode-table>
    <script>
      const createHeader = (data) => {
        const header = document.getElementById("table-header");
        header.innerHTML = "";

        for (const v of Object.keys(data[0].entries)) {
          header.innerHTML += `<vscode-table-header-cell>${v}</vscode-table-header-cell>`;
        }
      };

      const createBody = (data) => {
        const body = document.getElementById("table-body");
        body.innerHTML = "";

        for (const row of data) {
          const r = document.createElement("vscode-table-row");

          for (const v of Object.values(row.entries)) {
            r.innerHTML += `<vscode-table-cell>${v.value}</vscode-table-cell>`;
          }

          body.appendChild(r);
        }
      };

      window.addEventListener("message", (event) => {
        const message = event.data;

        console.log("Received message:", message);

        if (message.type === "setTableData") {
          const data = message.data.data || [];
          
          console.log(data);

          if (data.length > 0) {
            createHeader(data);
            createBody(data);
          }
        }
      });
    </script>
  </body>
</html>
